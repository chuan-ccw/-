<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>店家訂單管理</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; padding: 20px; }
        .container { max-width: 1000px; background: #fff; padding: 30px; border-radius: 10px; box-shadow: 0 0 15px rgba(0,0,0,0.1); }
        .page-header { border-bottom: 2px solid #0d6efd; margin-bottom: 25px; padding-bottom: 10px; }
        .btn-detail { width: 100px; }
        .status-btn { width: 100%; }
        .status-completed { background-color: #198754; color: white; cursor: default; }
    </style>
</head>
<body>
    <div class="container">
        <div class="d-flex justify-content-between align-items-center page-header">
            <h2>{{ store_name }} 的所有訂單 (ID: {{ store_id }})</h2>
            <a href="{{ url_for('index') }}" class="btn btn-secondary">回首頁</a>
        </div>

        <table class="table table-striped table-hover align-middle text-center">
            <thead class="table-dark">
                <tr>
                    <th>訂單編號</th>
                    <th>顧客電話</th>
                    <th>總金額</th>
                    <th>狀態</th>
                    <th>詳細資訊</th>
                </tr>
            </thead>
            <tbody>
                {% for order in orders %}
                <tr>
                    <td>{{ order.order_id }}</td>
                    <td>{{ order.phone }}</td>
                    <td><span class="badge bg-danger fs-6">${{ order.tot_price }}</span></td>
                    <td>
                        {% if order.status == '未完成' %}
                        <form action="{{ url_for('admin_update_status') }}" method="POST" onsubmit="return confirm('確定要將此訂單標記為「已完成」嗎？');">
                            <input type="hidden" name="order_id" value="{{ order.order_id }}">
                            <button type="submit" class="btn btn-warning status-btn">
                                待處理
                            </button>
                        </form>
                        {% else %}
                        <button class="btn status-completed status-btn" disabled>
                            已完成
                        </button>
                        {% endif %}
                    </td>
                    <td>
                        <a href="{{ url_for('admin_order_detail', order_id=order.order_id) }}" class="btn btn-info btn-sm btn-detail">
                            查看明細
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        {% if not orders %}
        <div class="alert alert-info text-center" role="alert">
            目前沒有任何訂單。
        </div>
        {% endif %}
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>